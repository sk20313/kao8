<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°é«˜çš„éº»è¡£ç›¸æ³•éŠæˆ²å±‹ - é¢ç›¸åˆ†æå·¥å…·</title>
    <style>
        /* ---------- ç‰ˆé¢èˆ‡é…è‰² ---------- */
        *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI','Microsoft JhengHei',sans-serif;}
        body{background:linear-gradient(135deg,#1a2a6c,#b21f1f,#1a2a6c);color:#fff;min-height:100vh;padding:20px;background-attachment:fixed;}
        .container{max-width:1000px;margin:0 auto;background:rgba(0,0,30,.85);border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.5);overflow:hidden;border:1px solid #4f8bf9;}
        header{background:rgba(0,20,60,.9);padding:25px;text-align:center;border-bottom:3px solid #4f8bf9;position:relative;}
        h1{font-size:2.5rem;margin-bottom:10px;color:#4f8bf9;text-shadow:0 2px 4px rgba(0,0,0,.5);}
        .subtitle{font-size:1.2rem;opacity:.9;max-width:600px;margin:0 auto;}
        .main-content{display:flex;flex-wrap:wrap;padding:20px;}
        .upload-section,.result-section{flex:1;min-width:300px;padding:20px;background:rgba(10,25,60,.7);border-radius:15px;margin:10px;}
        h2{color:#4f8bf9;margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid #4f8bf9;}
        .upload-area{border:3px dashed #4f8bf9;border-radius:15px;padding:30px;text-align:center;cursor:pointer;transition:.3s;margin-bottom:20px;background:rgba(20,40,80,.4);}
        .upload-area:hover{background:rgba(30,60,120,.5);transform:translateY(-3px);}
        .upload-icon{font-size:4rem;margin-bottom:15px;color:#4f8bf9;}
        .btn{background:linear-gradient(to right,#4f8bf9,#6a5af9);color:#fff;border:none;padding:14px 28px;font-size:1.1rem;border-radius:50px;cursor:pointer;transition:.3s;display:block;width:100%;margin:20px 0;font-weight:bold;letter-spacing:1px;box-shadow:0 5px 15px rgba(0,0,0,.3);}
        .btn:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,.4);}
        .btn:active{transform:translateY(1px);}
        .btn:disabled{background:#555;cursor:not-allowed;transform:none;box-shadow:none;}
        #imagePreview{max-width:100%;max-height:500px;border-radius:10px;background:#0a1429;margin-top:15px;display:none;border:2px solid #4f8bf9;object-fit:contain;}
        .result-box{background:rgba(20,40,80,.4);border-radius:15px;padding:20px;margin-top:20px;border:2px solid #4f8bf9;}
        .result-item{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(79,139,249,.3);}
        .result-item:last-child{border-bottom:none;}
        .progress-container{height:20px;background:rgba(0,0,0,.3);border-radius:10px;margin:10px 0 20px;overflow:hidden;}
        .progress-bar{height:100%;background:linear-gradient(to right,#4f8bf9,#6a5af9);border-radius:10px;width:0%;transition:width 1s ease-in-out;}
        footer{text-align:center;padding:20px;background:rgba(0,20,60,.9);margin-top:20px;border-top:1px solid #4f8bf9;}
        .note{font-size:.9rem;opacity:.7;margin-top:5px;}
        .marker-instructions{background:rgba(20,40,80,.4);border-radius:10px;padding:15px;margin:15px 0;border-left:4px solid #4f8bf9;}
        .marker-instructions ol{padding-left:20px;margin:10px 0;}
        .marker-instructions li{margin-bottom:8px;}
        .point-marker{position:absolute;width:12px;height:12px;border-radius:50%;background:red;transform:translate(-50%,-50%);z-index:10;}
        .point-label{position:absolute;background:rgba(0,0,0,.7);color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;transform:translate(10px,-10px);z-index:10;}
        .image-container{position:relative;display:inline-block;margin:10px 0;max-width:100%;text-align:center;}
        @media(max-width:768px){.main-content{flex-direction:column;}h1{font-size:2rem;}}
        .interpretation{margin-top:20px;padding:15px;background:rgba(20,40,80,.4);border-radius:10px;border-left:4px solid #4f8bf9;}
        .interpretation h3{color:#4f8bf9;margin-bottom:10px;}
        .interpretation p{margin-bottom:10px;}
        .sample-images{display:flex;justify-content:space-around;flex-wrap:wrap;margin-top:20px;gap:15px;}
        .sample-image{width:120px;height:120px;border-radius:10px;cursor:pointer;border:2px solid #4f8bf9;object-fit:cover;transition:.3s;}
        .sample-image:hover{transform:scale(1.05);box-shadow:0 5px 15px rgba(0,0,0,.3);}
        .sample-container{text-align:center;margin-top:20px;}
        .decoration{position:absolute;top:20px;right:20px;font-size:2.5rem;opacity:.5;}
        .game-house-title{color:#ffcc00;text-shadow:0 0 10px rgba(255,204,0,.5);}
        .ratio-fix-note{color:#ffcc00;font-size:.9rem;margin-top:10px;display:block;}
        .point-number{position:absolute;color:white;font-size:10px;font-weight:bold;left:50%;top:50%;transform:translate(-50%, -50%);z-index:11;}
        .success-message{color:#4f8bf9;font-weight:bold;margin-top:10px;display:none;}
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1><span class="game-house-title">å°é«˜çš„éº»è¡£ç›¸æ³•éŠæˆ²å±‹</span></h1>
        <p class="subtitle">é¢ç›¸åˆ†æå·¥å…· - æ‰‹å‹•æ¨™è¨˜é»ç‰ˆæœ¬</p>
        <div class="decoration">â˜¯</div>
    </header>

    <div class="main-content">
        <!-- â–²â–² ä¸Šå‚³å€ â–²â–² -->
        <div class="upload-section">
            <h2>ä¸Šå‚³ç…§ç‰‡</h2>
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“·</div>
                <p>é»æ“Šæˆ–æ‹–æ”¾é¢éƒ¨ç…§ç‰‡åˆ°é€™è£¡</p>
                <p class="note">(æ­£é¢æ¸…æ™°ç…§ç‰‡æ•ˆæœæœ€ä½³)</p>
                <span class="ratio-fix-note">âœ“ å·²ä¿®å¾©åœ–ç‰‡æ¯”ä¾‹å•é¡Œ</span>
                <input type="file" id="fileInput" accept="image/*" style="display:none;">
            </div>

            <div class="marker-instructions">
                <p><strong>æ¨™è¨˜æ­¥é©Ÿï¼š</strong></p>
                <ol>
                    <li>é»æ“Š<strong>é«®éš›ç·šä¸­é»</strong>ï¼ˆé¡é ­é ‚éƒ¨ä¸­å¤®ï¼‰</li>
                    <li>é»æ“Š<strong>çœ‰å¿ƒä½ç½®</strong>ï¼ˆå…©çœ‰ä¹‹é–“ï¼‰</li>
                    <li>é»æ“Š<strong>é¼»ä¸‹é»</strong>ï¼ˆé¼»å­”ä¸‹æ–¹ï¼‰</li>
                    <li>é»æ“Š<strong>ä¸‹å·´å°–</strong>ï¼ˆä¸‹å·´æœ€åº•éƒ¨ï¼‰</li>
                </ol>
                <p>æ¨™è¨˜å®Œæˆå¾Œé»æ“Šã€Œè¨ˆç®—æ¯”ä¾‹ã€</p>
                <p class="success-message" id="successMessage">âœ“ æ¨™è¨˜é»å·²è¨­ç½®å®Œæˆï¼Œè«‹é»æ“Šè¨ˆç®—æ¯”ä¾‹</p>
            </div>

            <button class="btn" id="calculateBtn" disabled>è¨ˆç®—æ¯”ä¾‹</button>
            <button class="btn" id="resetBtn">é‡ç½®æ¨™è¨˜é»</button>

            <div id="imageContainer" class="image-container">
                <img id="imagePreview" alt="é¢éƒ¨ç…§ç‰‡é è¦½">
            </div>

            <!-- ç¯„ä¾‹åœ–ç‰‡ -->
            <div class="sample-container">
                <h3>ç¯„ä¾‹åœ–ç‰‡</h3>
                <p class="note">é»æ“Šä¸‹æ–¹ç¯„ä¾‹åœ–ç‰‡å¿«é€Ÿé«”é©—åˆ†æåŠŸèƒ½</p>
                <div class="sample-images">
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=200&w=200" alt="ç¯„ä¾‹1" class="sample-image" id="sample1">
                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=200&w=200" alt="ç¯„ä¾‹2" class="sample-image" id="sample2">
                    <img src="https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=200&w=200" alt="ç¯„ä¾‹3" class="sample-image" id="sample3">
                </div>
            </div>
        </div>

        <!-- â–²â–² çµæœå€ â–²â–² -->
        <div class="result-section">
            <h2>åˆ†æçµæœ</h2>
            <div class="result-box" id="resultBox" style="display:none;">
                <div class="result-item">
                    <span>ä¸Šåº­æ¯”ä¾‹ï¼ˆé¡é ­ï¼‰</span><span id="upperRatio">--%</span>
                </div>
                <div class="progress-container"><div class="progress-bar" id="upperBar"></div></div>

                <div class="result-item">
                    <span>ä¸­åº­æ¯”ä¾‹ï¼ˆçœ‰çœ¼é¼»ï¼‰</span><span id="middleRatio">--%</span>
                </div>
                <div class="progress-container"><div class="progress-bar" id="middleBar"></div></div>

                <div class="result-item">
                    <span>ä¸‹åº­æ¯”ä¾‹ï¼ˆå£ä¸‹å·´ï¼‰</span><span id="lowerRatio">--%</span>
                </div>
                <div class="progress-container"><div class="progress-bar" id="lowerBar"></div></div>

                <div class="result-item">
                    <span><strong>ä¸‰åº­å¤±è¡¡ä¿‚æ•¸</strong></span><span id="imbalanceValue">--%</span>
                </div>
                <div class="result-item">
                    <span>é»ƒé‡‘æ¯”ä¾‹åå·®</span><span id="goldenDeviation">--%</span>
                </div>

                <div class="interpretation" id="interpretation">
                    <h3>é¢ç›¸è§£è®€</h3>
                    <p>è«‹ä¸Šå‚³ç…§ç‰‡ä¸¦æ¨™è¨˜é»å¾ŒæŸ¥çœ‹é¢ç›¸è§£è®€</p>
                </div>
            </div>

            <div id="initialMessage">
                <p>ä¸Šå‚³é¢éƒ¨ç…§ç‰‡å¾Œï¼ŒæŒ‰ç…§æŒ‡ç¤ºæ¨™è¨˜å››å€‹é—œéµé»ã€‚</p>
                <p class="note">æœ¬å·¥å…·å®Œå…¨åœ¨ç€è¦½å™¨ä¸­é‹è¡Œï¼Œä¸æœƒä¸Šå‚³ä»»ä½•è³‡æ–™è‡³ä¼ºæœå™¨ã€‚</p>
            </div>
        </div>
    </div>

    <footer>
        <p>å°é«˜çš„éº»è¡£ç›¸æ³•éŠæˆ²å±‹ v1.1 | ç¹é«”ç‰ˆ</p>
        <p class="note">æ³¨æ„ï¼šæœ¬å·¥å…·åƒ…ä¾›å¨›æ¨‚åƒè€ƒï¼Œå¯¦éš›é¢ç›¸åˆ†æéœ€å°ˆæ¥­äººå£«é€²è¡Œ</p>
    </footer>
</div>

<!-- ---------- ä¸»ç¨‹å¼ ---------- -->
<script>
/* ==== å–å¾— DOM ==== */
const fileInput       = document.getElementById('fileInput');
const uploadArea      = document.getElementById('uploadArea');
const imagePreview    = document.getElementById('imagePreview');
const imageContainer  = document.getElementById('imageContainer');
const calculateBtn    = document.getElementById('calculateBtn');
const resetBtn        = document.getElementById('resetBtn');
const resultBox       = document.getElementById('resultBox');
const initialMessage  = document.getElementById('initialMessage');
const interpretation  = document.getElementById('interpretation');
const upperRatio      = document.getElementById('upperRatio');
const middleRatio     = document.getElementById('middleRatio');
const lowerRatio      = document.getElementById('lowerRatio');
const upperBar        = document.getElementById('upperBar');
const middleBar       = document.getElementById('middleBar');
const lowerBar        = document.getElementById('lowerBar');
const imbalanceValue  = document.getElementById('imbalanceValue');
const goldenDeviation = document.getElementById('goldenDeviation');
const successMessage  = document.getElementById('successMessage');
const sample1         = document.getElementById('sample1');
const sample2         = document.getElementById('sample2');
const sample3         = document.getElementById('sample3');

/* ==== å…¨åŸŸè®Šæ•¸ ==== */
let markers = []; // å­˜å„²æ¨™è¨˜é»
let imageLoaded = false; // åœ–ç‰‡æ˜¯å¦å·²åŠ è¼‰

/* ==== äº‹ä»¶ç›£è½ ==== */
// é»æ“Šä¸Šå‚³å€åŸŸè§¸ç™¼æ–‡ä»¶é¸æ“‡
uploadArea.addEventListener('click', () => {
    fileInput.click();
});

// æ–‡ä»¶é¸æ“‡äº‹ä»¶
fileInput.addEventListener('change', handleFileSelect);

// æ‹–æ”¾åŠŸèƒ½
uploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadArea.style.background = 'rgba(30, 60, 120, 0.5)';
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.style.background = 'rgba(20,40,80,.4)';
});

uploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadArea.style.background = 'rgba(20,40,80,.4)';
    
    if (e.dataTransfer.files.length) {
        fileInput.files = e.dataTransfer.files;
        handleFileSelect(e);
    }
});

// è¨ˆç®—æŒ‰éˆ•
calculateBtn.addEventListener('click', calculateRatios);

// é‡ç½®æŒ‰éˆ•
resetBtn.addEventListener('click', resetMarkers);

// ç¯„ä¾‹åœ–ç‰‡é»æ“Š
sample1.addEventListener('click', () => loadSampleImage('sample1'));
sample2.addEventListener('click', () => loadSampleImage('sample2'));
sample3.addEventListener('click', () => loadSampleImage('sample3'));

/* ==== å‡½æ•¸å®šç¾© ==== */
// è™•ç†æ–‡ä»¶é¸æ“‡
function handleFileSelect(e) {
    const file = fileInput.files[0];
    if (!file || !file.type.match('image.*')) {
        alert('è«‹é¸æ“‡æœ‰æ•ˆçš„åœ–ç‰‡æ–‡ä»¶ï¼');
        return;
    }

    const reader = new FileReader();
    reader.onload = (e) => {
        imagePreview.src = e.target.result;
        imagePreview.style.display = 'block';
        imageLoaded = true;
        
        // åœ–ç‰‡åŠ è¼‰å®Œæˆå¾Œè¨­ç½®é»æ“Šäº‹ä»¶
        imagePreview.onload = () => {
            resetMarkers();
            imageContainer.addEventListener('click', handleImageClick);
        };
    };
    reader.readAsDataURL(file);
}

// è™•ç†åœ–ç‰‡é»æ“Šï¼ˆæ·»åŠ æ¨™è¨˜é»ï¼‰
function handleImageClick(e) {
    if (!imageLoaded || markers.length >= 4) return;
    
    // ç²å–é»æ“Šä½ç½®ç›¸å°æ–¼å®¹å™¨çš„åº§æ¨™
    const rect = imageContainer.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    // å‰µå»ºæ¨™è¨˜é»
    createMarker(x, y, markers.length + 1);
    
    // æ·»åŠ åˆ°æ¨™è¨˜é»æ•¸çµ„
    markers.push({x, y, id: markers.length + 1});
    
    // ç•¶æ¨™è¨˜é»é”åˆ°4å€‹æ™‚å•Ÿç”¨è¨ˆç®—æŒ‰éˆ•
    if (markers.length === 4) {
        calculateBtn.disabled = false;
        successMessage.style.display = 'block';
    }
}

// å‰µå»ºæ¨™è¨˜é»å…ƒç´ 
function createMarker(x, y, number) {
    const marker = document.createElement('div');
    marker.className = 'point-marker';
    marker.style.left = `${x}px`;
    marker.style.top = `${y}px`;
    
    const label = document.createElement('div');
    label.className = 'point-number';
    label.textContent = number;
    
    marker.appendChild(label);
    imageContainer.appendChild(marker);
}

// è¨ˆç®—ä¸‰åº­æ¯”ä¾‹
function calculateRatios() {
    if (markers.length < 4) {
        alert('è«‹å…ˆæ¨™è¨˜æ‰€æœ‰å››å€‹é»ï¼');
        return;
    }
    
    // ç¢ºä¿æ¨™è¨˜é»æŒ‰ç…§é †åºæ’åˆ—ï¼ˆå¾ä¸Šåˆ°ä¸‹ï¼‰
    markers.sort((a, b) => a.y - b.y);
    
    // è¨ˆç®—å„åº­é«˜åº¦
    const upperHeight = markers[1].y - markers[0].y;
    const middleHeight = markers[2].y - markers[1].y;
    const lowerHeight = markers[3].y - markers[2].y;
    const totalHeight = markers[3].y - markers[0].y;
    
    // è¨ˆç®—æ¯”ä¾‹
    const upperPercent = Math.round((upperHeight / totalHeight) * 100);
    const middlePercent = Math.round((middleHeight / totalHeight) * 100);
    const lowerPercent = Math.round((lowerHeight / totalHeight) * 100);
    
    // è¨ˆç®—å¤±è¡¡ä¿‚æ•¸ï¼ˆèˆ‡ç†æƒ³33.3%çš„åå·®ç¸½å’Œï¼‰
    const imbalance = Math.round(
        Math.abs(upperPercent - 33.3) + 
        Math.abs(middlePercent - 33.3) + 
        Math.abs(lowerPercent - 33.3)
    );
    
    // è¨ˆç®—é»ƒé‡‘æ¯”ä¾‹åå·®ï¼ˆç†æƒ³æ¯”ä¾‹ç‚º1:1:1ï¼‰
    const goldenDev = Math.round(
        Math.abs(upperPercent - 33.3) + 
        Math.abs(middlePercent - 33.3) + 
        Math.abs(lowerPercent - 33.3)
    );
    
    // æ›´æ–°UI
    updateResults(upperPercent, middlePercent, lowerPercent, imbalance, goldenDev);
    
    // é¡¯ç¤ºçµæœå€åŸŸ
    resultBox.style.display = 'block';
    initialMessage.style.display = 'none';
}

// æ›´æ–°çµæœé¡¯ç¤º
function updateResults(upper, middle, lower, imbalance, goldenDev) {
    upperRatio.textContent = `${upper}%`;
    middleRatio.textContent = `${middle}%`;
    lowerRatio.textContent = `${lower}%`;
    imbalanceValue.textContent = `${imbalance}%`;
    goldenDeviation.textContent = `${goldenDev}%`;
    
    // è¨­ç½®é€²åº¦æ¢
    upperBar.style.width = `${upper}%`;
    middleBar.style.width = `${middle}%`;
    lowerBar.style.width = `${lower}%`;
    
    // ç”Ÿæˆè§£è®€
    generateInterpretation(upper, middle, lower, imbalance);
}

// ç”Ÿæˆé¢ç›¸è§£è®€
function generateInterpretation(upper, middle, lower, imbalance) {
    let interpretationHTML = '<h3>é¢ç›¸è§£è®€</h3>';
    
    // ä¸Šåº­è§£è®€ï¼ˆé¡é ­ï¼‰
    if (upper > 38) {
        interpretationHTML += `<p>ä¸Šåº­æ¯”ä¾‹è¼ƒé«˜ (${upper}%)ï¼šæ‚¨æ“æœ‰å¯¬å»£çš„é¡é ­ï¼Œä»£è¡¨æ—©å¹´é‹å‹¢è¼ƒä½³ï¼Œæ™ºåŠ›ç™¼å±•è‰¯å¥½ï¼Œæœ‰è¼ƒå¼·çš„é‚è¼¯æ€ç¶­èƒ½åŠ›ã€‚åœ¨äº‹æ¥­ä¸Šå®¹æ˜“ç²å¾—è²´äººææ”œï¼Œé©åˆå¾äº‹éœ€è¦å‰µæ„å’Œæ€è€ƒçš„å·¥ä½œã€‚</p>`;
    } else if (upper < 28) {
        interpretationHTML += `<p>ä¸Šåº­æ¯”ä¾‹è¼ƒä½ (${upper}%)ï¼šæ‚¨çš„é¡é ­ç›¸å°è¼ƒçª„ï¼Œä»£è¡¨æ—©å¹´å¯èƒ½éœ€è¦æ›´å¤šåŠªåŠ›ã€‚ä½†é€™ä¹Ÿé¡¯ç¤ºæ‚¨æœ‰å‹™å¯¦çš„æ€§æ ¼ï¼Œè…³è¸å¯¦åœ°ï¼Œèƒ½å¤ é€šéå¾Œå¤©åŠªåŠ›å½Œè£œå…ˆå¤©çš„ä¸è¶³ã€‚</p>`;
    } else {
        interpretationHTML += `<p>ä¸Šåº­æ¯”ä¾‹å‡è¡¡ (${upper}%)ï¼šæ‚¨çš„é¡é ­æ¯”ä¾‹é©ä¸­ï¼Œä»£è¡¨æ—©å¹´é‹å‹¢å¹³ç©©ï¼Œå­¸ç¿’èƒ½åŠ›è‰¯å¥½ï¼Œå®¶åº­ç’°å¢ƒä¹Ÿè¼ƒç‚ºç©©å®šã€‚</p>`;
    }
    
    // ä¸­åº­è§£è®€ï¼ˆçœ‰çœ¼é¼»ï¼‰
    if (middle > 38) {
        interpretationHTML += `<p>ä¸­åº­æ¯”ä¾‹è¼ƒé«˜ (${middle}%)ï¼šæ‚¨çš„çœ‰çœ¼é¼»å€åŸŸè¼ƒé•·ï¼Œé¡¯ç¤ºä¸­å¹´é‹å‹¢å¼·å‹ã€‚æ‚¨å¯èƒ½æœ‰è¼ƒå¼·çš„äº‹æ¥­å¿ƒå’Œé ˜å°èƒ½åŠ›ï¼Œé©åˆæ“”ä»»ç®¡ç†è·ä½ã€‚ä½†éœ€æ³¨æ„å·¥ä½œå£“åŠ›å¯èƒ½å°å¥åº·é€ æˆå½±éŸ¿ã€‚</p>`;
    } else if (middle < 28) {
        interpretationHTML += `<p>ä¸­åº­æ¯”ä¾‹è¼ƒä½ (${middle}%)ï¼šæ‚¨çš„ä¸­åº­è¼ƒçŸ­ï¼Œä»£è¡¨ä¸­å¹´é‹å‹¢éœ€è¦æ›´å¤šä¸»å‹•çˆ­å–ã€‚æ‚¨å¯èƒ½æ›´æ³¨é‡å®¶åº­ç”Ÿæ´»ï¼Œäº‹æ¥­ä¸Šéœ€è¦æ›´å¤šè€å¿ƒå’Œå …æŒæ‰èƒ½å–å¾—æˆåŠŸã€‚</p>`;
    } else {
        interpretationHTML += `<p>ä¸­åº­æ¯”ä¾‹å‡è¡¡ (${middle}%)ï¼šæ‚¨çš„ä¸­åº­æ¯”ä¾‹é©ä¸­ï¼Œé¡¯ç¤ºä¸­å¹´é‹å‹¢å¹³ç©©ï¼Œäº‹æ¥­å’Œå®¶åº­èƒ½å¤ ä¿æŒè‰¯å¥½å¹³è¡¡ã€‚</p>`;
    }
    
    // ä¸‹åº­è§£è®€ï¼ˆå£ä¸‹å·´ï¼‰
    if (lower > 38) {
        interpretationHTML += `<p>ä¸‹åº­æ¯”ä¾‹è¼ƒé«˜ (${lower}%)ï¼šæ‚¨çš„ä¸‹å·´å€åŸŸè¼ƒé•·ï¼Œä»£è¡¨æ™šå¹´é‹å‹¢è‰¯å¥½ï¼Œæœ‰ç¦æ°£äº«å—è¾›å‹¤å·¥ä½œçš„æˆæœã€‚æ‚¨å¯èƒ½æœ‰è¼ƒå¼·çš„æ„å¿—åŠ›å’Œæ±ºæ–·åŠ›ï¼Œèƒ½å¤ å …æŒè‡ªå·±çš„ç›®æ¨™ã€‚</p>`;
    } else if (lower < 28) {
        interpretationHTML += `<p>ä¸‹åº­æ¯”ä¾‹è¼ƒä½ (${lower}%)ï¼šæ‚¨çš„ä¸‹å·´è¼ƒçŸ­ï¼Œä»£è¡¨æ™šå¹´éœ€è¦æ›´å¤šç”Ÿæ´»è¦åŠƒã€‚æ‚¨å¯èƒ½æœ‰è¼ƒå¼·çš„å‰µé€ åŠ›å’Œè—è¡“å¤©åˆ†ï¼Œé©åˆå¾äº‹å‰µæ„ç›¸é—œçš„å·¥ä½œã€‚</p>`;
    } else {
        interpretationHTML += `<p>ä¸‹åº­æ¯”ä¾‹å‡è¡¡ (${lower}%)ï¼šæ‚¨çš„ä¸‹å·´æ¯”ä¾‹é©ä¸­ï¼Œä»£è¡¨æ™šå¹´ç”Ÿæ´»å¹³ç©©ï¼Œèƒ½å¤ äº«å—å¤©å€«ä¹‹æ¨‚ã€‚</p>`;
    }
    
    // æ•´é«”è§£è®€
    if (imbalance < 20) {
        interpretationHTML += `<p><strong>æ•´é«”åˆ†æï¼š</strong>æ‚¨çš„ä¸‰åº­æ¯”ä¾‹ç›¸ç•¶å‡è¡¡ (å¤±è¡¡ä¿‚æ•¸${imbalance}%)ï¼Œä»£è¡¨ä¸€ç”Ÿé‹å‹¢è¼ƒç‚ºå¹³ç©©ï¼Œå„æ–¹é¢ç™¼å±•è¼ƒç‚ºå‡è¡¡ã€‚é€™ç¨®é¢ç›¸é¡¯ç¤ºæ‚¨æ€§æ ¼ç©©å®šï¼Œè™•äº‹å‘¨å…¨ï¼Œå®¹æ˜“ç²å¾—ä»–äººçš„ä¿¡ä»»ã€‚</p>`;
    } else if (imbalance > 40) {
        interpretationHTML += `<p><strong>æ•´é«”åˆ†æï¼š</strong>æ‚¨çš„ä¸‰åº­æ¯”ä¾‹æœ‰è¼ƒå¤§å·®ç•° (å¤±è¡¡ä¿‚æ•¸${imbalance}%)ï¼Œä»£è¡¨äººç”Ÿå¯èƒ½æœƒæœ‰è¼ƒæ˜é¡¯çš„èµ·ä¼éšæ®µã€‚é€™ç¨®é¢ç›¸é¡¯ç¤ºæ‚¨æ€§æ ¼é®®æ˜ï¼Œæœ‰ç¨ç‰¹çš„æ‰è¯å’Œå‰µé€ åŠ›ï¼Œé©åˆåœ¨ç‰¹å®šé ˜åŸŸç™¼å±•ã€‚</p>`;
    } else {
        interpretationHTML += `<p><strong>æ•´é«”åˆ†æï¼š</strong>æ‚¨çš„ä¸‰åº­æ¯”ä¾‹æœ‰ä¸€å®šå·®ç•° (å¤±è¡¡ä¿‚æ•¸${imbalance}%)ï¼Œä»£è¡¨äººç”Ÿæœƒæœ‰ä¸åŒçš„ç™¼å±•éšæ®µã€‚é€™ç¨®é¢ç›¸é¡¯ç¤ºæ‚¨é©æ‡‰èƒ½åŠ›å¼·ï¼Œèƒ½å¤ åœ¨ä¸åŒç’°å¢ƒä¸­æ‰¾åˆ°è‡ªå·±çš„ä½ç½®ã€‚</p>`;
    }
    
    interpretation.innerHTML = interpretationHTML;
}

// é‡ç½®æ¨™è¨˜é»
function resetMarkers() {
    // ç§»é™¤æ‰€æœ‰æ¨™è¨˜é»
    const markers = document.querySelectorAll('.point-marker');
    markers.forEach(marker => marker.remove());
    
    // é‡ç½®æ•¸çµ„
    markers.length = 0;
    
    // ç¦ç”¨è¨ˆç®—æŒ‰éˆ•
    calculateBtn.disabled = true;
    
    // éš±è—æˆåŠŸæ¶ˆæ¯
    successMessage.style.display = 'none';
    
    // é‡ç½®çµæœé¡¯ç¤º
    if (resultBox.style.display === 'block') {
        resultBox.style.display = 'none';
        initialMessage.style.display = 'block';
    }
    
    // é‡ç½®é€²åº¦æ¢
    upperBar.style.width = '0%';
    middleBar.style.width = '0%';
    lowerBar.style.width = '0%';
    
    // é‡ç½®è§£è®€
    interpretation.innerHTML = '<h3>é¢ç›¸è§£è®€</h3><p>è«‹ä¸Šå‚³ç…§ç‰‡ä¸¦æ¨™è¨˜é»å¾ŒæŸ¥çœ‹é¢ç›¸è§£è®€</p>';
}

// åŠ è¼‰ç¯„ä¾‹åœ–ç‰‡
function loadSampleImage(sampleId) {
    // è¨­ç½®å°æ‡‰çš„ç¯„ä¾‹åœ–ç‰‡
    let sampleSrc = '';
    switch(sampleId) {
        case 'sample1':
            sampleSrc = 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&w=500';
            break;
        case 'sample2':
            sampleSrc = 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&w=500';
            break;
        case 'sample3':
            sampleSrc = 'https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?crop=entropy&cs=tinysrgb&fit=crop&fm=jpg&h=500&w=500';
            break;
    }
    
    // è¨­ç½®åœ–ç‰‡æº
    imagePreview.src = sampleSrc;
    imagePreview.style.display = 'block';
    imageLoaded = true;
    
    // é‡ç½®æ¨™è¨˜é»
    resetMarkers();
    
    // æ¨¡æ“¬åœ–ç‰‡åŠ è¼‰
    imagePreview.onload = () => {
        imageContainer.addEventListener('click', handleImageClick);
        alert('ç¯„ä¾‹åœ–ç‰‡å·²åŠ è¼‰ï¼Œè«‹æŒ‰ç…§æŒ‡ç¤ºæ¨™è¨˜å››å€‹é»');
    };
}

// åˆå§‹åŒ–
resetMarkers();
</script>
</body>
</html>
